#!/bin/bash

if [ -z "$1" ]; then
  echo "Error: You must provide the URL of the Node.js binary."
  echo "Usage: ./install-node.sh <url_to_nodejs_binary>"
  exit 1
fi

# Assign the URL to a variable
NODE_URL="$1"

# Extract the filename from the URL
NODE_FILE=$(basename "$NODE_URL")

# Download the Node.js binary
echo "Downloading Node.js binary from $NODE_URL..."
wget "$NODE_URL" -O "$NODE_FILE"

# Check if download was successful
if [ $? -ne 0 ]; then
  echo "Error: Failed to download the Node.js binary."
  exit 1
fi

# Extract the tar.xz file
echo "Extracting $NODE_FILE..."
tar -xJf "$NODE_FILE"

# Extract the folder name by stripping off the extension
NODE_DIR="${NODE_FILE%.tar.xz}"

# Move the extracted folder to /usr/local/
echo "Moving Node.js to /usr/local/$NODE_DIR..."
sudo mv "$NODE_DIR" /usr/local/

# Create symbolic links for node and npm in /usr/local/bin
echo "Creating symlinks for node and npm..."
sudo ln -sf /usr/local/"$NODE_DIR"/bin/node /usr/local/bin/node
sudo ln -sf /usr/local/"$NODE_DIR"/bin/npm /usr/local/bin/npm

# Clean up: remove the downloaded tarball
echo "Cleaning up..."
rm "$NODE_FILE"

# Verify installation
echo "Node.js version:"
node -v
echo "npm version:"
npm -v

echo "Node.js installation complete!"
